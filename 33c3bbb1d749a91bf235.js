(self.webpackChunkwebtool_qrcode=self.webpackChunkwebtool_qrcode||[]).push([[626],{395:(t,e,a)=>{let r=function(){return Promise.reject(new Error("server side render not support"))};new Function("try {return this===window;}catch(e){ return false;}")()&&(r=a(650)),t.exports=r},626:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>l});var r=a(592);const n={render:function(){var t=this.$createElement;return(this._self._c||t)("canvas",{ref:"qr",staticClass:"border"})},staticRenderFns:[],props:["value"],watch:{value:function(t){this.text=t,this.draw()}},data:function(){return{text:this.value||""}},mounted:function(){this.draw()},methods:{draw:function(){r.toCanvas(this.$refs.qr,this.text,{errorCorrectionLevel:"H"},(function(t){t&&console.error(t)}))}}};const s={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{on:{paste:function(e){return e.preventDefault(),t.onPaste.apply(null,arguments)},drop:function(e){return e.preventDefault(),t.onDrop.apply(null,arguments)},dragover:function(t){t.preventDefault()}}},[t._t("default")],2)},staticRenderFns:[],props:[],data:()=>({}),mounted(){},methods:{onPaste(t){[...t.clipboardData.files].forEach((t=>{this.parseImg(t)}))},onDrop(t){[...t.dataTransfer.files].forEach((t=>{this.parseImg(t)}))},parseImg:function(t){const e=this,a=new window.FileReader;a.addEventListener("load",(function(){const t=a.result,r=new window.Image;r.onload=function(){e.$emit("load",r,e)},r.src=t}),!1),t&&a.readAsDataURL(t)}}};const o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.id?a("div",{staticClass:"d-inline-block"},[a("b-form-file",{staticStyle:{display:"none"},attrs:{id:t.id,placeholder:"請選擇檔案...",accept:".jpg, .png",plain:""},on:{change:t.parseFile}}),a("label",{staticClass:"btn btn-secondary btn-sm",attrs:{for:t.id}},[a("b-icon-card-image")],1)],1):t._e()},staticRenderFns:[],props:[],data:()=>({id:""}),mounted(){this.id=`img-${this._uid}`},methods:{parseFile(t){const e=this,a=t.srcElement,r=a.files[0];a.value="";const n=new window.FileReader;n.addEventListener("load",(function(){const t=n.result,a=new window.Image;a.onload=function(){e.$emit("load",a)},a.src=t}),!1),r&&n.readAsDataURL(r)}}};var i=a(395),c=a.n(i);const l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container-fluid px-0"},[t._m(0),a("div",{staticClass:"container-fluid row"},[a("b-card",{staticClass:"col-6"},[a("b-card-title",[t._v("generator")]),a("b-form-input",{attrs:{placeholder:"qrcode data"},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),t.text?[a("b-card-title",[t._v("qrcode")]),a("qrcode",{model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})]:t._e()],2),a("b-card",{staticClass:"col-6"},[a("imager-reader",{on:{load:function(e){return t.$refs.zbar.scanImage(e)}}},[a("b-card-title",{staticClass:"d-inline-block"},[t._v("zbar")]),a("open-image",{staticClass:"ml-1",on:{load:function(e){return t.$refs.zbar.scanImage(e)}}})],1),a("zbar-provider",{ref:"zbar",attrs:{"origin-image-portal":"originImage","loc-image-portal":"locImage"},on:{result:function(e){t.result=JSON.stringify(e,null,4)}}}),t.result?[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[a("b-card-title",[t._v("origin")]),a("portal-target",{attrs:{name:"originImage"}})],1),a("div",{staticClass:"col-6"},[a("b-card-title",[t._v("loc")]),a("portal-target",{attrs:{name:"locImage"}})],1)]),a("h5",[t._v("result")]),a("pre",[t._v(t._s(t.result))])]:t._e()],2)],1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{staticClass:"navbar navbar-dark bg-dark"},[a("div",{staticClass:"navbar-brand d-flex"},[a("div",[t._v("webtool qrcode")])])])}],components:{Qrcode:n,ImagerReader:s,OpenImage:o,ZbarProvider:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[t.originImagePortal?a("portal",{attrs:{to:t.originImagePortal}},[t.img?a("img",{staticClass:"w-100",attrs:{src:t.img.src}}):t._e()]):t._e(),t.locImagePortal?a("portal",{attrs:{to:t.locImagePortal}},[t.locImageUrl?a("img",{staticClass:"w-100",attrs:{src:t.locImageUrl}}):t._e()]):t._e()],1)},staticRenderFns:[],props:["originImagePortal","locImagePortal"],data:()=>({img:null,locImageUrl:""}),mounted(){},methods:{async scanImage(t){this.img=t;const{width:e,height:a}=t,r=document.createElement("canvas");Object.assign(r,{width:e,height:a});const n=await window.createImageBitmap(t),s=r.getContext("2d");s.drawImage(n,0,0,e,a);const o=s.getImageData(0,0,e,a),i=await c()(o);this.$emit("result",i.slice()),this.makeLocImageUrl(o,i)},makeLocImageUrl(t,e){const a=document.createElement("canvas"),r=e.shift();if(!r)return void(this.locImageUrl=a.toDataURL("image/png"));const n=a.getContext("2d"),{width:s}=t,o=512,i=512,c=r.loc;Object.assign(a,{width:o,height:i});const l=n.createImageData(o,i),d=(c[3].x-c[0].x)/o,m=(c[1].x-c[0].x)/i,u=(c[2].x+c[0].x-c[3].x-c[1].x)/(o*i),g=c[0].x,f=(c[3].y-c[0].y)/o,p=(c[1].y-c[0].y)/i,h=(c[2].y+c[0].y-c[3].y-c[1].y)/(o*i),v=c[0].y;for(let e=0;e<i;e++)for(let a=0;a<o;a++){const r=4*(e*o+a),n=parseInt(d*a+m*e+u*a*e+g),i=4*(parseInt(f*a+p*e+h*a*e+v)*s+n);l.data[r]=t.data[i],l.data[r+1]=t.data[i+1],l.data[r+2]=t.data[i+2],l.data[r+3]=t.data[i+3]}n.putImageData(l,0,0),this.locImageUrl=a.toDataURL("image/png")}}}},data:()=>({text:"",result:""}),methods:{}}}}]);